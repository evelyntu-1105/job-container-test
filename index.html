<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>工作設計型態測驗</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { color: #857672; background-color: #f5f5f5; }
        .option-bg { background-color: #B3A7A7; }
        .option-btn:hover { border-color: #9AB992; background-color: #FDFDFB; }
        .btn-primary { background-color: #D3DB9A; color: #FFFFFF; transition: all 0.3s ease; }
        .btn-primary:hover { background-color: #9AB992; transform: translateY(-1px); }
        .text-custom-title { color: #B4A8A6; }
        .text-progress { color: #9AB992; }
        .bg-custom-progress { background-color: #D3DB9A; }
        .pre-line { white-space: pre-line; }
        .hidden { display: none; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 md:p-8">

    <div id="progress-container" class="w-full max-w-2xl mb-8 hidden">
        <div class="flex justify-between mb-2 text-sm font-medium tracking-wide">
            <span id="progress-text" class="text-progress">第 1 / 15 題</span>
            <span id="progress-percent" class="text-progress">0%</span>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-1.5">
            <div id="progress-bar" class="bg-custom-progress h-1.5 rounded-full transition-all duration-500" style="width: 0%"></div>
        </div>
    </div>

    <main class="w-full max-w-2xl bg-white rounded-3xl shadow-sm p-8 md:p-12">
        
        <div id="start-screen" class="text-center md:text-left">
            <h1 class="text-3xl font-bold mb-8 leading-tight">工作設計型態測驗：<br>你看清你待的「容器」了嗎？</h1>
            <div class="text-lg mb-10 space-y-6 leading-relaxed opacity-90">
                <p>今天這個測驗不是在測你，也不是在測能力。</p>
                <p>它其實是在幫我們看清一件事：我們現在待的工作，是怎麼被設計的。</p>
                <p>思考「我是不是不夠好」的同時，也了解「這個工作是用什麼邏輯在運作」。</p>
            </div>
            <button onclick="startQuiz()" class="btn-primary w-full py-5 rounded-2xl text-xl font-bold shadow-sm">
                開始看清我的工作設計
            </button>
        </div>

        <div id="quiz-screen" class="hidden">
            <h2 id="question-group" class="text-custom-title font-bold mb-3 text-lg tracking-widest uppercase"></h2>
            <h3 id="question-text" class="text-2xl font-bold mb-10 leading-snug"></h3>
            <div id="options-container" class="space-y-4"></div>
            <button onclick="prevQuestion()" id="prev-btn" class="mt-10 flex items-center gap-2 font-medium opacity-60 hover:opacity-100 transition">
                ← 回上一題
            </button>
        </div>

        <div id="result-screen" class="hidden text-center">
            <div class="flex justify-center mb-6">
                <span id="result-tag" class="px-4 py-1 rounded-full text-xs font-bold text-white tracking-widest"></span>
            </div>
            <h2 id="result-title" class="text-4xl font-black mb-8"></h2>
            
            <div class="space-y-6 mb-12">
                <div class="text-left p-6 rounded-2xl bg-gray-50/50 border border-gray-100">
                    <h4 class="font-bold mb-3 text-lg" style="color: #857672;">角色介紹</h4>
                    <p id="result-intro" class="text-base leading-relaxed pre-line opacity-90 text-[#857672]"></p>
                </div>
            </div>

            <div class="text-left p-8 rounded-3xl border-2 mb-10" style="background-color: #FDFDFB; border-color: #D3DB9A;">
                <h4 class="font-bold mb-4 text-lg">這份工作的樣態推論</h4>
                <div id="diagnosis-content" class="text-base leading-relaxed pre-line opacity-80 mb-6 text-[#857672]"></div>
                
                <hr class="border-[#D3DB9A]/30 my-6">
                
                <h4 class="font-bold mb-4 text-lg">給你的提醒</h4>
                <p id="result-bottomNote" class="text-base leading-relaxed pre-line opacity-80"></p>
            </div>

            <div class="text-xs italic mb-10 leading-loose text-[#B4A8A6] text-left">
                <p>「這不是標籤，也不是評價。它只是告訴你：你現在待的是哪一種『被設計好的工作容器』。」</p>
                <p class="mt-4 pre-line">若是感到消耗，通常是你對工作的期待與所待的容器不匹配。

這不是在評斷你或公司的優劣 。請試著看清：你的職業期待（你想要如何被使用、想要多少決策空間）與這個職位目前的設計定位（它是被設計成穩定執行還是決策參與）之間是否存在落差。

看清容器的形狀，是為了幫你找到更精準的語言，去描述你現在的狀態，並決定下一步該如何調整或對話 。</p>
            </div>

            <div class="mt-16 pt-10 border-t border-gray-100 text-left">
                <h4 class="text-lg font-bold mb-8 text-[#857672]">看清別種工作容器的形狀</h4>
                <div id="other-types" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    </div>
            </div>
            
            <button onclick="showFeedback()" class="btn-primary w-full py-5 rounded-2xl text-lg font-bold mt-12">
                下一步：分享你的感想
            </button>
        </div>

        <div id="feedback-screen" class="hidden">
            <h2 class="text-2xl font-bold mb-8 text-center">感謝參與！請分享你的真實感受</h2>
            <form id="feedback-form" class="space-y-6">
                <div class="space-y-2">
                    <label class="block text-sm font-bold opacity-80">這份測驗針對的工作，是你目前的：</label>
                    <select id="job-stage" class="w-full border-2 border-gray-100 rounded-xl p-4 outline-none focus:border-indigo-200 transition" required>
                        <option value="">請選擇</option>
                        <option>第一份打工(兼任)工作</option>
                        <option>非第一份打工(兼任)工作</option>
                        <option>第一份實習</option>
                        <option>非第一份實習</option>
                        <option>第一份正職工作</option>
                        <option>非第一份正職工作</option>
                    </select>
                </div>
                <div class="space-y-2">
                    <label class="block text-sm font-bold opacity-80">符合度確認</label>
                    <textarea id="feedback-match" rows="3" class="w-full border-2 border-gray-100 rounded-xl p-4 outline-none focus:border-indigo-200" placeholder="與現況相符嗎？為什麼？"></textarea>
                </div>
                <div class="space-y-2">
                    <label class="block text-sm font-bold opacity-80">任何其他對這個測驗的感受或想法</label>
                    <textarea id="feedback-other" rows="3" class="w-full border-2 border-gray-100 rounded-xl p-4 outline-none focus:border-indigo-200" placeholder="請填寫任何建議..."></textarea>
                </div>
                <button type="submit" id="submit-btn" class="btn-primary w-full py-5 rounded-2xl font-bold">送出回饋並完成</button>
            </form>
        </div>

        <div id="final-screen" class="hidden text-center py-10">
            <h2 class="text-3xl font-bold mb-6">已收到你的回饋！</h2>
            <p class="mb-10 text-lg opacity-80">你看清的不是自己的極限，而是工作的邊界。<br>看得懂容器，是一輩子的能力。</p>
            <button onclick="location.reload()" class="font-bold text-lg hover:underline" style="color: #9AB992;">重新測驗</button>
        </div>
    </main>

    <script>
        const quizData = [
            { group: "一、決策密度", text: "在這份工作中，我多久需要做一次「會影響方向或結果」的決定？", options: { A: "幾乎沒有，主要是照需求執行", B: "偶爾，有一些小決定", C: "經常，需要自己判斷方向或取捨" } },
            { group: "一、決策密度", text: "當事情卡關或不確定時，公司期待我怎麼做？", options: { A: "等明確指示再行動", B: "提出想法，請人確認", C: "自己判斷並承擔結果" } },
            { group: "一、決策密度", text: "如果我今天不在，這份工作會發生什麼事？", options: { A: "幾乎不受影響，任何人都能快速接手", B: "需要一點交接，但流程清楚", C: "會卡住，因為需要我的判斷或脈絡" } },
            { group: "二、腦力使用與思考空間", text: "我每天的工作內容中，有多少需要思考「為什麼要這樣做」？", options: { A: "幾乎沒有，只要照做", B: "偶爾，需要理解背景", C: "經常，需要理解目的與脈絡" } },
            { group: "二、腦力使用與思考空間", text: "我能不能對需求或做法提出質疑或替代方案？", options: { A: "幾乎不行，需求已經定好", B: "可以提出，但不一定會被採納", C: "被期待提出不同做法一起討論" } },
            { group: "二、腦力使用與思考空間", text: "我是否常覺得「其實不用我想這麼多，也可以完成」？", options: { A: "非常常", B: "偶爾", C: "很少或幾乎沒有" } },
            { group: "三、角色邊界與成長可能", text: "如果我把現在的工作做得很好，通常會發生什麼？", options: { A: "被分配更多一樣的事情", B: "事情變多一點，內容差不多", C: "角色範圍或影響力會擴大" } },
            { group: "三、角色邊界與成長可能", text: "這個角色是否有明確的「下一階段樣貌」？", options: { A: "沒有，主要靠年資累積", B: "有模糊方向，但不清楚", C: "有清楚的責任升級或定位變化" } },
            { group: "三、角色邊界與成長可能", text: "在這個位置上，我是否被允許嘗試不同做法？", options: { A: "不太行，流程固定", B: "小範圍可以", C: "被鼓勵嘗試與優化" } },
            { group: "四、責任歸屬與學習結構", text: "當我第一次做一件不熟的事情時，通常會發生什麼？", options: { A: "有人示範或清楚說明標準", B: "給方向，細節自己摸", C: "直接交給我，之後看結果" } },
            { group: "四、責任歸屬與學習結構", text: "當事情結果不理想時，第一個被檢討的是什麼？", options: { A: "流程或資訊是否不足", B: "分工或溝通問題", C: "個人能力或主動性" } },
            { group: "四、責任歸屬與學習結構", text: "在這個地方，「學會了」通常代表什麼？", options: { A: "能照流程完成、不出錯", B: "能撐住、不問、不造成麻煩", C: "知道為什麼這樣做，能獨立判斷" } },
            { group: "五、未來感與自我想像", text: "如果我三年後還在這裡，我能否清楚想像自己的狀態？", options: { A: "很模糊，只是資深一點", B: "大概知道，但不確定", C: "很清楚自己會成為什麼樣的專業者" } },
            { group: "五、未來感與自我想像", text: "想到這個三年後的自己，我的感受比較接近？", options: { A: "空或麻木", B: "普通、還好", C: "踏實或期待" } },
            { group: "五、未來感與自我想像", text: "當我想到「繼續待在這裡」時，內在感覺比較像？", options: { A: "停滯、卡住", B: "穩定但有點空", C: "安心且有方向" } }
        ];

        const resultCards = {
            type1: { 
                id: "type1", title: "量產的標準量杯", tag: "# 執行穩定型", tagColor: "#D3DB9A", 
                intro: "量杯的使命是追求極致的穩定與精確。它是為了「零誤差」而誕生的，因此被設計得透明且刻度清晰，確保任何人拿起它，都能精準量出相同的結果。它不需要具備改變形狀的野心，它的美感存在於「重複」與「可預測性」之中。只要刻度不歪，它就是最安全、最被系統依賴的基石。",
                bottomNote: "如果你現在需要的是生活節奏的穩定，這個量杯很好；但如果你想當液體自由流動，你會覺得這裡太擠了。" 
            },
            type2: { 
                id: "type2", title: "裂縫的暫存土碗", tag: "# 過渡撐住型", tagColor: "#D3DB9A", 
                intro: "土碗的宿命是在正式規則尚未建立時，用血肉之軀撐起空隙。它雖然粗糙、甚至帶著裂縫，卻是組織中最靈活的補丁。它被設計成「不上不下」的狀態，因為它的價值就在於填補那些模糊、未定義的邊界。它常常感到疲累，是因為它不僅要裝東西，還要耗費額外的力氣去平衡那些因設計不周而產生的裂縫。",
                bottomNote: "這種卡住感往往是結構性的，而非你的能力問題。建議思考：你追求的成長，這個定位是否真的能給予？" 
            },
            type3: { 
                id: "type3", title: "陶藝師的培植花盆", tag: "# 專業成長型", tagColor: "#D3DB9A", 
                intro: "花盆的設計，是為了承載「時間」與「生命力」的緩慢轉化。它不急著要你立刻產出刻度，而是提供足夠的土壤與試錯空間。它被設計成可以隨時「換盆」的結構，因為它預見了你會長大、會紮根、會變得比現在更繁茂。在這裡，所有的辛苦都不是損耗，而是轉化為根系養分的必經過程。",
                bottomNote: "適合願意深耕的人，它被設計成可以長出未來的樣貌。" 
            },
            type4: { 
                id: "type4", title: "無邊界的實驗燒瓶", tag: "# 決策參與型", tagColor: "#D3DB9A", 
                intro: "燒瓶是被設計來承載最劇烈的反應與最沉重的決策責任。它是為了「未知」而設計的。在實驗室的熱火中，它不裝現成的刻度，而是裝滿了「判斷」與「取捨」。它的壓力不來自於體力的勞動，而是來自於它必須作為主導者，確保每一次化學反應都能通往正確的結論。它是高成長的代名詞，也是高耗能的發動機。",
                bottomNote: "高成長也高耗能，你的主體性就是你的產出。請評估個人能量與職業期望的平衡。" 
            },
            type5: { 
                id: "type5", title: "漏斗狀的拋棄式紙杯", tag: "# 消耗型容器", tagColor: "#D3DB9A", 
                intro: "紙杯的設計邏輯是「低成本」與「即時消耗」，它不打算留下任何累積。它被設計得輕巧、簡單，卻也極其脆弱。它沒有厚實的底部，東西倒進去、流出來，任務就結束了。它不要求你生根，也不要求你思考，它只需要你作為一個暫時的管道。感到空虛是必然的，因為紙杯的設計初衷，本來就沒打算承載人的成長。",
                bottomNote: "認清這點是停止自責的第一步。不要試圖改變液體的形狀去適應一個漏水的紙杯，請看清職位定位。" 
            }
        };

        let currentStep = 0;
        let userAnswers = [];

        function startQuiz() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            document.getElementById('progress-container').classList.remove('hidden');
            renderQuestion();
        }

        function renderQuestion() {
            const q = quizData[currentStep];
            document.getElementById('question-group').innerText = q.group;
            document.getElementById('question-text').innerText = q.text;
            document.getElementById('prev-btn').style.visibility = currentStep === 0 ? 'hidden' : 'visible';
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            ['A', 'B', 'C'].forEach(label => {
                const btn = document.createElement('button');
                btn.className = "option-btn w-full text-left p-6 border-2 border-gray-50 rounded-2xl font-medium flex gap-4 items-center transition-all shadow-sm";
                btn.innerHTML = `<span class="option-bg text-white w-8 h-8 flex items-center justify-center rounded-lg text-sm shrink-0">${label}</span> <span>${q.options[label]}</span>`;
                btn.onclick = () => selectOption(label);
                container.appendChild(btn);
            });
            updateProgress();
        }

        function updateProgress() {
            const percent = Math.round((currentStep / quizData.length) * 100);
            document.getElementById('progress-text').innerText = `第 ${currentStep + 1} / ${quizData.length} 題`;
            document.getElementById('progress-percent').innerText = `${percent}%`;
            document.getElementById('progress-bar').style.width = `${percent}%`;
        }

        function selectOption(label) {
            userAnswers[currentStep] = label;
            if (currentStep < quizData.length - 1) {
                currentStep++;
                renderQuestion();
            } else {
                showResults();
            }
        }

        function prevQuestion() {
            if (currentStep > 0) {
                currentStep--;
                renderQuestion();
            }
        }

        function showResults() {
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('progress-container').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');

            const counts = { A: 0, B: 0, C: 0 };
            userAnswers.forEach(ans => counts[ans]++);
            
            const q1to12 = userAnswers.slice(0, 12);
            const q1to12Counts = { A: 0, B: 0, C: 0 };
            q1to12.forEach(ans => q1to12Counts[ans]++);
            const q13to15 = userAnswers.slice(12, 15);
            const q13to15Counts = { A: 0, B: 0, C: 0 };
            q13to15.forEach(ans => q13to15Counts[ans]++);

            let resultObj;
            // 未來感校正邏輯
            if (q13to15Counts.A >= 2) {
                resultObj = (q1to12Counts.A >= 6) ? resultCards.type5 : resultCards.type2;
            } else if (q13to15Counts.C >= 2) {
                resultObj = (q1to12Counts.C >= 6) ? resultCards.type4 : resultCards.type3;
            } else {
                if (counts.A >= 8) resultObj = resultCards.type1;
                else if (counts.B >= 6) resultObj = resultCards.type2;
                else if (counts.B + counts.C >= 9 && counts.C >= 4) resultObj = resultCards.type3;
                else if (counts.C >= 7) resultObj = resultCards.type4;
                else resultObj = resultCards.type5;
            }

            // 基礎資料填充
            const tagEl = document.getElementById('result-tag');
            tagEl.innerText = resultObj.tag;
            tagEl.style.backgroundColor = resultObj.tagColor;
            document.getElementById('result-title').innerText = resultObj.title;
            document.getElementById('result-intro').innerText = resultObj.intro;
            document.getElementById('result-bottomNote').innerText = resultObj.bottomNote;

            // 樣態推論診斷
            const q1T = quizData[0].options[userAnswers[0]];
            const q3T = quizData[2].options[userAnswers[2]];
            const q2T = quizData[1].options[userAnswers[1]];
            const q12T = quizData[11].options[userAnswers[11]];
            const q5T = quizData[4].options[userAnswers[4]];
            const q14T = quizData[13].options[userAnswers[13]];

            let diag = "";
            if(resultObj.id === "type1") diag = `從您提供的資訊，在決策密度上感受到「${q1T}」，且當你不在時「${q3T}」。\n\n這顯示這份工作是被設計成一個高品質的標準量杯，系統優先追求流程的穩定性，而非個人的主動判斷。`;
            else if(resultObj.id === "type2") diag = `您提到遇到卡關或不確定時會「${q2T}」，且在目前職位上學會了代表「${q12T}」。\n\n這代表您在容器中扮演的是救援與填補的土碗角色，高度依賴個人的適應力來維持系統運作，因此最容易產生卡住的疲累感。`;
            else if(resultObj.id === "type3") diag = `您目前被期待「${q5T}」，且對三年後在這裡的感受是「${q14T}」。\n\n這顯示目前的容器具備培植花盆的特徵，雖然現在感到辛苦，但這是一個健康的專業積累路徑，你的努力正轉化為您的個人專業資產。`;
            else if(resultObj.id === "type4") diag = `您在決策上「${q1T}」，且思考空間上感受到「${quizData[5].options[userAnswers[5]]}」。\n\n這代表您目前處於實驗燒瓶中。系統高度依賴您的主導與判斷作為核心產出，消耗感通常來自於決策責任的重量。`;
            else diag = `由於您提到目前日常工作中思考空間「${q5T}」，且想到繼續待著的感覺是「${quizData[14].options[userAnswers[14]]}」。\n\n這印證了這份工作是被設計成一次性消耗的紙杯容器，並不打算留住專業累積，掏空感是由於容器設計本就不承載人。`;
            
            document.getElementById('diagnosis-content').innerText = diag;

            // 展示其他類型
            const otherContainer = document.getElementById('other-types');
            otherContainer.innerHTML = '';
            Object.keys(resultCards).forEach(key => {
                if (resultCards[key].id !== resultObj.id) {
                    const div = document.createElement('div');
                    div.className = "flex flex-col items-center p-4 bg-gray-50 rounded-xl grayscale opacity-60";
                    // 此處可替換圖片連結
                    div.innerHTML = `
                        <div class="w-16 h-16 bg-gray-200 rounded-full mb-3 flex items-center justify-center text-xl font-bold">?</div>
                        <span class="text-xs font-bold text-center">${resultCards[key].title}</span>
                    `;
                    otherContainer.appendChild(div);
                }
            });
        }

        function showFeedback() {
            document.getElementById('result-screen').classList.add('hidden');
            document.getElementById('feedback-screen').classList.remove('hidden');
        }

        // 資料送出邏輯
        document.getElementById('feedback-form').onsubmit = function(e) {
            e.preventDefault();
            const scriptURL = 'https://script.google.com/macros/s/AKfycbzklLT2YToNAHDtOQ8DZkDEOnZ1XcZa3kUJC-SlfDp-gKm8A5p92Ws3wA3eGWCiE6oC/exec';
            
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.innerText = "傳送中...";
            submitBtn.disabled = true;

            const data = {
                resultTitle: document.getElementById('result-title').innerText,
                jobStage: document.getElementById('job-stage').value,
                matchFeedback: document.getElementById('feedback-match').value,
                otherFeedback: document.getElementById('feedback-other').value
            };

            fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify(data)
            })
            .then(() => {
                document.getElementById('feedback-screen').classList.add('hidden');
                document.getElementById('final-screen').classList.remove('hidden');
            })
            .catch(error => {
                alert('傳送失敗，請稍後再試！');
                submitBtn.innerText = "重新送出";
                submitBtn.disabled = false;
            });
        };
    </script>
</body>
</html>
